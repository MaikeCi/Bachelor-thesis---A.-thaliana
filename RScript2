#Data input
Tabelle_noShoot <- read.csv2("Traits_vegetative.csv")
Tabelle_Shoot <- read.csv2("Traits_Spiekeroog.csv")


#Median, mean, variance, standard deviation
#no shoot
median_noShoot <- round(as.matrix(apply(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],2,median,na.rm=TRUE)),digits=2)
mean_noShoot <- round(as.matrix(apply(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],2,mean,na.rm=TRUE)),digits=2)
var_noShoot <- round(as.matrix(apply(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],2,var,na.rm=TRUE)),digits=2)
sd_noShoot <- round(as.matrix(apply(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],2,sd,na.rm=TRUE)),digits=2)
values_noShoot <- cbind(median_noShoot,mean_noShoot,var_noShoot,sd_noShoot)
colnames(values_noShoot)=c("median","mean","variance","standard deviation")
#shoot
median_Shoot <- round(as.matrix(apply(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],2,median,na.rm=TRUE)),digits=2)
mean_Shoot <- round(as.matrix(apply(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],2,mean,na.rm=TRUE)),digits=2)
var_Shoot <- round(as.matrix(apply(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],2,var,na.rm=TRUE)),digits=2)
sd_Shoot <- round(as.matrix(apply(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],2,sd,na.rm=TRUE)),digits=2)
values_Shoot <- cbind(median_Shoot,mean_Shoot,var_Shoot,sd_Shoot)
colnames(values_Shoot)=c("median","mean","variance","standard deviation")

#correlations and significance
library("ggcorrplot")
library("RColorBrewer")
#no shoot
cor_mat_Tabelle_noShoot <- round(cor(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)], use="complete.obs"),digits=2)
corrp.mat_noShoot <- round(cor_pmat(cor_mat_Tabelle_noShoot),digits=2)
ggcorrplot(cor_mat_Tabelle_noShoot, hc.order =TRUE, type ="lower", 
           p.mat = corrp.mat_noShoot,sig.level = 0.05, col=brewer.pal(3, "YlGnBu"),title="Correlations and significance", lab=TRUE, lab_size = 2,pch.cex=5)+ theme(axis.text.x = element_text(size=5),axis.text.y = element_text(size=5))


#Shoot
cor_mat_Tabelle_Shoot <- round(cor(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)], use="complete.obs"), digits=2)
corrp.mat_Shoot <- round(cor_pmat(cor_mat_Tabelle_Shoot),digits=2)
ggcorrplot(cor_mat_Tabelle_Shoot, hc.order =TRUE, type ="lower", 
  p.mat = corrp.mat_Shoot, title="Correlations and significance", lab=TRUE, lab_size = 1,pch.cex=2)+ theme(axis.text.x = element_text(size=5),axis.text.y = element_text(size=5))


#create different plots and wilcox testing
library("ggplot2")
library("GGally")
#no shoot
ggpairs(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],lower = list(continuous = wrap("points", size=0.1) ))+theme_grey(base_size = 3)
#eaten_leaves
ggplot(Tabelle_noShoot,aes(leaves_number,eaten_leafes))+geom_boxplot()
ggplot(Tabelle_noShoot,aes(leaves_number,eaten_leafes))+geom_violin()
wilcox.test(leaves_number~eaten_leafes, data=Tabelle_noShoot,subset=eaten_leafes%in%c("y","n"))
ggplot(Tabelle_noShoot,aes(root_length_cm,eaten_leafes))+geom_violin()
wilcox.test(root_length_cm~eaten_leafes, data=Tabelle_noShoot,subset=eaten_leafes%in%c("y","n"))
ggplot(Tabelle_noShoot,aes(length_longest_leaf_cm,eaten_leafes))+geom_violin()
wilcox.test(length_longest_leaf_cm~eaten_leafes, data=Tabelle_noShoot,subset=eaten_leafes%in%c("y","n"))
ggplot(Tabelle_noShoot,aes(petiole_longest_leaf_cm,eaten_leafes))+geom_violin()
wilcox.test(petiole_longest_leaf_cm~eaten_leafes, data=Tabelle_noShoot,subset=eaten_leafes%in%c("y","n"))
ggplot(Tabelle_noShoot,aes(width_longest_leaf_cm,eaten_leafes))+geom_violin()
wilcox.test(width_longest_leaf_cm~eaten_leafes, data=Tabelle_noShoot,subset=eaten_leafes%in%c("y","n"))
ggplot(Tabelle_noShoot,aes(petiole.length,eaten_leafes))+geom_violin()
wilcox.test(petiole.length~eaten_leafes, data=Tabelle_noShoot,subset=eaten_leafes%in%c("y","n"))
ggplot(Tabelle_noShoot,aes(length.width,eaten_leafes))+geom_violin()
wilcox.test(length.width~eaten_leafes, data=Tabelle_noShoot,subset=eaten_leafes%in%c("y","n"))


#shoot
ggpairs(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],lower = list(continuous = wrap("points", size=0.01) ),upper = list(continuous = wrap("cor", size=1)))+theme(axis.text.x = element_text(size=2),axis.text.y = element_text(size=2))+theme_grey(base_size = 3)

#location
ggplot(Tabelle_Shoot,aes(reproductive_units,location))+geom_boxplot()
ggplot(Tabelle_Shoot,aes(reproductive_units,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(leaf_number,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(petiole_cm, location))+geom_violin()
ggplot(Tabelle_Shoot,aes(leaf_length_cm,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(leaf_width_cm,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(petiole_total_length,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(length_width,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(internodium_cm,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(stem_mm,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(cauline_leaves,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(plant_length_cm,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(plant_length_root_length,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(sideshoots,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(sidebranches,location))+geom_violin()

#mainshoot yes/no
ggplot(Tabelle_Shoot,aes(reproductive_units,mainshoot))+geom_boxplot()
ggplot(Tabelle_Shoot,aes(reproductive_units,mainshoot))+geom_violin()
wilcox.test(reproductive_units~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(leaf_number,mainshoot))+geom_violin()
wilcox.test(leaf_number~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(petiole_cm, mainshoot))+geom_violin()
wilcox.test(petiole_cm~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(leaf_length_cm,mainshoot))+geom_violin()
wilcox.test(leaf_length_cm~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(leaf_width_cm,mainshoot))+geom_violin()
wilcox.test(leaf_width_cm~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(petiole_total_length,mainshoot))+geom_violin()
wilcox.test(petiole_total_length~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(length_width,mainshoot))+geom_violin()
wilcox.test(length_width~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(internodium_cm,mainshoot))+geom_violin()
wilcox.test(internodium_cm~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(stem_mm,mainshoot))+geom_violin()
wilcox.test(stem_mm~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(cauline_leaves,mainshoot))+geom_violin()
wilcox.test(cauline_leaves~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(plant_length_cm,mainshoot))+geom_violin()
wilcox.test(plant_length_cm~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(plant_length_root_length,mainshoot))+geom_violin()
wilcox.test(plant_length_root_length~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(sideshoots,mainshoot))+geom_violin()
wilcox.test(sideshoots~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggplot(Tabelle_Shoot,aes(sidebranches,mainshoot))+geom_violin()
wilcox.test(sidebranches~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
