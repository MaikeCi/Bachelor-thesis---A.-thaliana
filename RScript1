#05.08.2022
#R Script

#Data input
Tabelle_noShoot <- read.csv2("Traits_vegetative.csv")
Tabelle_Shoot <- read.csv2("Traits_Spiekeroog.csv")


#Median, mean, variance, standard deviation
#no shoot
median_noShoot <- round(as.matrix(apply(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],2,median,na.rm=TRUE)),digits=2)
mean_noShoot <- round(as.matrix(apply(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],2,mean,na.rm=TRUE)),digits=2)
var_noShoot <- round(as.matrix(apply(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],2,var,na.rm=TRUE)),digits=2)
sd_noShoot <- round(as.matrix(apply(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],2,sd,na.rm=TRUE)),digits=2)

#shoot
median_Shoot <- round(as.matrix(apply(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],2,median,na.rm=TRUE)),digits=2)
mean_Shoot <- round(medians <- as.matrix(apply(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],2,mean,na.rm=TRUE)),digits=2)
var_Shoot <- round(as.matrix(apply(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],2,var,na.rm=TRUE)),digits=2)
sd_Shoot <- round(as.matrix(apply(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],2,sd,na.rm=TRUE)),digits=2)


#correlations and significance
library("ggcorrplot")
library("RColorBrewer")
#no shoot
cor_mat_Tabelle_noShoot <- round(cor(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)], use="complete.obs"),digits=2)
corrp.mat_noShoot <- round(cor_pmat(cor_mat_Tabelle_noShoot),digits=2)
ggcorrplot(cor_mat_Tabelle_noShoot, hc.order =TRUE, type ="lower", 
           p.mat = corrp.mat_noShoot,sig.level = 0.05, col=brewer.pal(3, "YlGnBu"),title="Correlations and significance", lab=TRUE, lab_size = 2,pch.cex=5)+ theme(axis.text.x = element_text(size=5),axis.text.y = element_text(size=5))


#Shoot
cor_mat_Tabelle_Shoot <- round(cor(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)], use="complete.obs"), digits=2)
corrp.mat_Shoot <- round(cor_pmat(cor_mat_Tabelle_Shoot),digits=2)
ggcorrplot(cor_mat_Tabelle_Shoot, hc.order =TRUE, type ="lower", 
  p.mat = corrp.mat_Shoot, title="Correlations and significance", lab=TRUE, lab_size = 1,pch.cex=2)+ theme(axis.text.x = element_text(size=5),axis.text.y = element_text(size=5))


#Grafiken erstellen
library("ggplot2")
library("GGally")
#no shoot
ggpairs(Tabelle_noShoot[sapply(Tabelle_noShoot,is.numeric)],lower = list(continuous = wrap("points", size=0.1) ))+theme_grey(base_size = 3)
ggplot(Tabelle_noShoot,aes(leaves_number,eaten_leafes))+geom_boxplot()
ggplot(Tabelle_noShoot,aes(length_longest_leaf_cm,eaten_leafes))+geom_boxplot()
ggplot(Tabelle_noShoot,aes(length.width,eaten_leafes))+geom_boxplot()


#shoot
ggpairs(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)],lower = list(continuous = wrap("points", size=0.01) ),upper = list(continuous = wrap("cor", size=1)))+theme(axis.text.x = element_text(size=2),axis.text.y = element_text(size=2))+theme_grey(base_size = 3)


ggplot(Tabelle_Shoot,aes(flowers,location))+geom_boxplot()
ggplot(Tabelle_Shoot,aes(flowers,location))+geom_violin()
ggplot(Tabelle_Shoot,aes(flowers,mainshoot))+geom_boxplot()
ggplot(Tabelle_Shoot,aes(sideshoots,mainshoot))+geom_boxplot()
ggplot(Tabelle_Shoot,aes(cauline_leaves,mainshoot))+geom_boxplot()
wilcox.test(cauline_leaves~mainshoot, data=Tabelle_Shoot,subset=mainshoot%in%c("y","n"))
ggcorr(Tabelle_Shoot[sapply(Tabelle_Shoot,is.numeric)], method = c("pairwise", "pearson"))
